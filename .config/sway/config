exec 'systemctl --user import-environment; systemctl --user start sway-session.target'

# WM configuration
workspace_layout        tabbed
focus_follows_mouse     no

font                    monospace 0
default_border          none
default_floating_border none
default_dim_inactive    0.30

#output DP-1 resolution 1920x1080@144Hz position 1920,0

input "type:keyboard" {
    xkb_layout us
    repeat_delay 200
    repeat_rate 45
}

input "type:pointer" accel_profile "flat"
input "type:touchpad" events disabled

#--------------------------------- Appearance ---------------------------------#
exec ${XDG_CONFIG_HOME:-$HOME/.config}/sway/scripts/theme startup

# Wallpaper
output * bg /nix/store/jhxhzfbgw3kh8z4v2p29fnc093i8chnc-wallhaven-x8ye3z.jpg fill

# Cursor 
seat seat0 xcursor_theme 'Numix-Cursor-Light' 24

#------------------------------------ Apps ------------------------------------#

# Workspace assignment
assign {
    [app_id="mpv"]        1
    [app_id="^firefox$"]  1
    [app_id="kotatogram"] 2
    [app_id="tawasal"]    2
}

# Individual windows behavior
no_focus [app_id="no_focus"]

for_window {
    [app_id="authentication-agent-1"] floating enable, move center
    [app_id="xdg-desktop-portal-gtk"] floating enable, move center
    [app_id="floating_term"]          floating enable, sticky enable, resize set 50 ppt 50 ppt
    [app_id="dragon"]                 floating enable, sticky enable, move position 0 ppt 0 ppt

    [title="Choose Files"]                     floating enable, move center, resize set 60 ppt 70 ppt
    [app_id="kotatogram" title="Media viewer"] fullscreen disable
    [app_id="tawasal" title="Media viewer"]    fullscreen disable

    # xwayland
    [window_role="task_dialog"]  floating enable
    [window_role="Preferences"]  floating enable
    [window_role="pop-up"]       floating enable
    [window_role="bubble"]       floating enable
    [window_role="dialog"]       floating enable
    [window_type="menu"]         floating enable
}

#-------------------------------- Key bindings --------------------------------#
set $mod Mod4
set $menu fuzzel
set $term $TERMINAL

bindsym {
    $mod+t exec $term
    $mod+d exec $menu
    $mod+a exec ${XDG_CONFIG_HOME:-$HOME/.config}/sway/scripts/actions

    $mod+q kill
    $mod+Shift+r reload
    $mod+Shift+q exit

    --locked {
        # Hardware
        XF86Tools            exec wpctl set-mute @DEFAULT_SOURCE@ toggle
        XF86AudioMute        exec wpctl set-mute @DEFAULT_SINK@ toggle
        XF86AudioRaiseVolume exec wpctl set-volume -l 1 @DEFAULT_SINK@ 5%+
        XF86AudioLowerVolume exec wpctl set-volume -l 1 @DEFAULT_SINK@ 5%-

        XF86MonBrightnessDown exec busctl --user call org.clight.clight /org/clight/clight org.clight.clight DecBl d 0.02
        XF86MonBrightnessUp   exec busctl --user call org.clight.clight /org/clight/clight org.clight.clight IncBl d 0.02

        # Media
        XF86Launch5  exec playerctl previous
        XF86Launch6  exec playerctl play-pause
        XF86Launch7  exec playerctl next
    }

    # Moving around
    $mod+h focus left
    $mod+j focus down
    $mod+k focus up
    $mod+l focus right

    $mod+Shift+h move left
    $mod+Shift+j move bottom
    $mod+Shift+k move top
    $mod+Shift+l move right
    $mod+Shift+m move position center

    # Workspaces
    $mod+1 workspace number 1
    $mod+2 workspace number 2
    $mod+3 workspace number 3
    $mod+4 workspace number 4
    $mod+5 workspace number 5
    $mod+6 workspace number 6
    $mod+7 workspace number 7
    $mod+8 workspace number 8
    $mod+9 workspace number 9
    $mod+0 workspace number 10

    $mod+Shift+1 move container to workspace number 1
    $mod+Shift+2 move container to workspace number 2
    $mod+Shift+3 move container to workspace number 3
    $mod+Shift+4 move container to workspace number 4
    $mod+Shift+5 move container to workspace number 5
    $mod+Shift+6 move container to workspace number 6
    $mod+Shift+7 move container to workspace number 7
    $mod+Shift+8 move container to workspace number 8
    $mod+Shift+9 move container to workspace number 9
    $mod+Shift+0 move container to workspace number 10

    # Layout stuff
    $mod+Shift+space floating toggle
    $mod+space       focus mode_toggle
    $mod+f           fullscreen

    $mod+w split horizontal
    $mod+s split vertical
    $mod+e split none

    $mod+control+h resize shrink width  10px
    $mod+control+j resize shrink height 10px
    $mod+control+k resize grow   height 10px
    $mod+control+l resize grow   width  10px
}
